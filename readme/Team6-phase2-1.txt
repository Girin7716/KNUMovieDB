DROP TABLE MOVIE CASCADE CONSTRAINT;
DROP TABLE GENRE CASCADE CONSTRAINT;
DROP TABLE RATING CASCADE CONSTRAINT;
DROP TABLE ACTOR CASCADE CONSTRAINT;
DROP TABLE EPISODE CASCADE CONSTRAINT;
DROP TABLE VERSION CASCADE CONSTRAINT;
DROP TABLE ACCOUNT CASCADE CONSTRAINT;
DROP TABLE APPEAR CASCADE CONSTRAINT;
DROP TABLE MOVIEIS CASCADE CONSTRAINT;

CREATE TABLE MOVIE -- INSERT 완료
(
Tconst VARCHAR(15) NOT NULL,
Title VARCHAR(200) NOT NULL,
Type VARCHAR(20),
Runtime NUMERIC,
Start_year DATE,
End_year DATE,
IsAdult NUMERIC,
PRIMARY KEY (Tconst)
);

CREATE TABLE GENRE -- INSERT 완료
(
Genre_Type VARCHAR(15),
PRIMARY KEY (Genre_Type)
);

CREATE TABLE RATING 
(
ParentAccount VARCHAR(10),
ParentTconst VARCHAR(15),
Rating DECIMAL(4,2) default 0,
PRIMARY KEY (ParentAccount,ParentTconst)
);

CREATE TABLE ACTOR -- INSERT 완료
(
Actor_id VARCHAR(10),
Name VARCHAR(50),
Bdate VARCHAR(5),
PRIMARY KEY(Actor_id)
);

CREATE TABLE EPISODE -- INSERT 완료
(
Tconst VARCHAR(15) NOT NULL,
ParentTconst VARCHAR(15),
SeasonNumber NUMERIC,
EpisodeNumber NUMERIC,
PRIMARY KEY (Tconst)
);

CREATE TABLE VERSION -- INSERT 완료
(
ParentTconst VARCHAR(15),
Ordering NUMERIC,
Title VARCHAR(200),
Region VARCHAR(7),
Language VARCHAR(7),
IsOriginalTtile NUMERIC,
PRIMARY KEY (ParentTconst, Ordering)
);

CREATE TABLE ACCOUNT -- INSERT 완료
(
Account_ID VARCHAR(10) NOT NULL,
Password VARCHAR(20) NOT NULL,
Fname VARCHAR(10) NOT NULL,
Lname VARCHAR(10) NOT NULL,
Phone_number VARCHAR(15) NOT NULL,
Address VARCHAR(30),
Sex VARCHAR(2),
Bdate DATE,
Membership VARCHAR(15) DEFAULT 'Basic',
Account_type NUMERIC,
Job VARCHAR (10),
PRIMARY KEY(Account_ID)
);


CREATE TABLE APPEAR --MOIVE랑 ACTOR
(
ParentActor_id VARCHAR(10),
ParentTconst VARCHAR(15),
PRIMARY KEY (ParentActor_id,ParentTconst)
);

CREATE TABLE MOVIEIS --MOVIE랑 GENRE
(
ParentTconst VARCHAR(15),
ParentGenreType VARCHAR(15),
PRIMARY KEY (ParentTconst,ParentGenreType)
);

ALTER TABLE EPISODE ADD FOREIGN KEY(ParentTconst) REFERENCES MOVIE (Tconst) ON DELETE CASCADE;
ALTER TABLE RATING ADD FOREIGN KEY(ParentAccount) REFERENCES ACCOUNT (Account_ID) ON DELETE CASCADE;
ALTER TABLE RATING ADD FOREIGN KEY(ParentTconst) REFERENCES MOVIE (Tconst) ON DELETE CASCADE;
ALTER TABLE VERSION ADD FOREIGN KEY(ParentTconst) REFERENCES MOVIE (Tconst) ON DELETE CASCADE;
ALTER TABLE APPEAR ADD FOREIGN KEY(ParentActor_id) REFERENCES ACTOR (Actor_id) ON DELETE CASCADE;
ALTER TABLE APPEAR ADD FOREIGN KEY(ParentTconst) REFERENCES MOVIE (Tconst) ON DELETE CASCADE;
ALTER TABLE MOVIEIS ADD FOREIGN KEY(ParentTconst) REFERENCES MOVIE (Tconst) ON DELETE CASCADE;
ALTER TABLE MOVIEIS ADD FOREIGN KEY(ParentGenreType) REFERENCES GENRE (Genre_Type) ON DELETE CASCADE;